# HTTP(HyperText Transfer Protocol)

- Port:80 Transport layer Protocol : TCP
- HTTP는 TCP 위에서 동작하는 응용 계층 프로토콜이다. 따라서 HTTP 요청은 TCP 방식의 일종이라고 할 수 있다
- 웹 서버에 웹페이지를 요청(request)하고 웹서버는 응답(reply)을 한다.
- HyperText Markup Language (HTML)을 사용하여 정보를 전달한다.
- 데이터가 텍스트로 전달되기 때문에 보안에 취약하다.

![http2](images/http2.png)

# HTTPS(HyperText Transfer Protocol Secure)

- Port:443 Transport layer Protocol : TCP
- 암호화를 사용한 Http 프로토콜
- 웹 서버에 웹페이지를 요청(request)하고 웹서버는 응답(reply)을 한다.
- HyperText Markup Language (HTML)을 사용하여 정보를 전달한다.
- 데이터가 암호화되어 전달되기 때문에 보안에 좋다.

## Https의 연결과정(핸드쉐이크 과정)

1. HTTPS 통신이 시작될 때, 클라이언트와 서버는 TLS 핸드셰이크 과정을 통해 서로의 신원을 확인하고, 세션 키를 생성하여 통신을 시작한다. 이 과정에는 다음 단계가 포함된다
2. 클라이언트가 서버에 연결 요청
3. 서버가 인증서(공개 키 포함)를 클라이언트에 전송
4. 클라이언트가 인증서를 검증한 후, 세션 키 생성
5. 클라이언트와 서버가 세션 키를 교환하여 암호화된 연결 설정

### HTTPS에서의 대칭키와 비대칭키

#### 비대칭키 (공개키/개인키)

- 사용 목적: 초기 암호화 키 교환
- 사용 시점: 클라이언트가 서버에 최초 접속할 때 (TLS Handshake)
- 동작
  - 서버는 공개키(Public Key)가 포함된 SSL 인증서를 클라이언트에게 보낸다.
  - 클라이언트는 이 공개키로 대칭키(세션키)를 암호화해서 서버에 보낸다.
- 서버는 자신의 개인키(Private Key)로 이 암호화된 대칭키를 복호화한다.

#### 대칭키 (세션키)

- 사용 목적: 데이터 실제 전송 시 암호화
- 사용 시점: 핸드셰이크 이후부터 모든 요청/응답에 사용됨
- 동작
  - 앞서 교환된 세션키를 이용해, 클라이언트와 서버는 동일한 키로 암호화/복호화한다. 이후 데이터 전송은 이 대칭키를 통해 수행된다.

#### 대칭키와 비대칭키

- 비대칭키: 자물쇠와 열쇠
  - 서버가 자물쇠(공개키)를 주고, 클라이언트는 자물쇠로 상자를 잠가 서버에게 보낸다, 서버만 열쇠(개인키)를 가지고 있어 열 수 있다.
  - 공개키(Public Key)로 잠그면, 개인키(Private Key)로만 열 수 있다.
  - 반대로, 개인키로 잠그면, 공개키로만 열 수 있다
- 대칭키: 서로 같은 열쇠 하나를 공유
  - 처음에 하나의 열쇠를 서로 공유하고, 이후 모든 메시지를 그 열쇠로 잠그고 연다.

#### HTTPS 통신 전체 흐름 요약

1. 서버는 CA(인증기관)로부터 발급받은 SSL 인증서(공개키 포함)를 보유하고 있으며, 클라이언트(브라우저)가 HTTPS로 접속하면 이 인증서를 클라이언트에게 전달한다.
2. 클라이언트는 브라우저 또는 운영체제에 사전 내장된 루트 인증서 목록을 바탕으로, 해당 인증서가 신뢰할 수 있는 CA로부터 발급되었는지, 인증서의 서명이 위조되지 않았는지, 유효 기간이 만료되지 않았는지 등을 검증한다.
3. 인증서가 유효하다고 판단되면, 클라이언트(브라우저)는 랜덤한 세션키(대칭키)를 생성하고, 이를 서버의 공개키로 암호화하여 서버에 전송한다.
4. 서버는 자신만이 알고 있는 개인키를 사용해 이 암호화된 세션키를 복호화하고, 클라이언트와 서버는 이로써 동일한 대칭키를 안전하게 공유하게 된다.
5. 이후부터의 모든 통신은 이 대칭키 기반의 암호화된 세션을 통해 빠르고 안전하게 이루어진다.
6. 즉, HTTPS는 비대칭키로 안전하게 세션키를 교환한 뒤, 대칭키로 효율적인 암호화 통신을 수행하는 구조이다.

![http1](images/http1.png)
