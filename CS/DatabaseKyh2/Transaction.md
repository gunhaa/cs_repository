# 트랜잭션

- 트랜잭션은 논리적으로 쪼개질 수 없는 하나 이상의 데이터베이스 작업 묶음(Unit of work)을 의미한다
- 트랜잭션은 All or Nothing이라는 원칙을 제공한다
  - 트랜잭션으로 묶인 작업은 모두 다 성공해야만 그 결과를 실제 데이터베이스에 영구 반영한다
  - 만약 작업 그룹내에서 단 하나의 작업이라도 실패하면 그 전에 성공했던 모든 작업을 전부 없던일로 되돌린다
  - Atomic 연산이라고도 불린다

## 트랜잭션이 필요한 이유

- 데이터 일관성을 위협하는 것은 잘못된 상태뿐이 아니다
  - 데이터를 변경하는 행위에서 문제가 생길수도 있다
- 트랜잭션이 없다면 주문하기라는 로직을 실행하기 어렵다
  - 주문하기는 단순해보이지만 2가지 작업을 순차적으로 처리해야한다
    1. 작업 1: orders 테이블에 새로운 주문 정보 INSERT
    2. 작업 2. products 테이블에서 주문된 상품의 재고 UPDATE하여 1만큼 줄인다
  - 이 두 작업은 논리적으로 절대 쪼개질 수 없는 하나의 묶음이다
    - 두 작업을 하나로 묶을 수 있는 트랜잭션이 없다면 일관성이 깨지는 문제가 발생할 수 있다

## 트랜잭션의 ACID 속성

- 데이터베이스 시스템 이론에서는 트랜잭션이 신뢰성을 갖추도록 반드시 지켜야할 4가지 속성을 ACID라고 부른다
- ACID는 모든 RDBS의 근간을 이루는 중요한 개념이다

### Atomic 원자성

- 트랜잭션은 하나의 원자처럼 더 이상 쪼갤 수 없는 논리적 단위이며, 전부 성공하거나 실패한다

### Consistency 일관성

- 트랜잭션이 성공하면, Database는 항상 일관된(valid) 상태를 유지해야한다

### Isolation 격리성

- 하나의 트랜잭션이 실행 중일 때, 다른 트랜잭션이 해당 트랜잭션의 중간 겨로가에 끼어들어 간섭할 수 없다
- 격리성이 없다면 로직이 완료되지 않은 중간 상태를 볼 수 있다(이를 Dirty read라고 한다)