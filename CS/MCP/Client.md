# MCP Client

> https://modelcontextprotocol.io/specification/2025-06-18/client/roots
> protocol version: 25-06-18

- 클라이언트의 기능은 아래 3가지가 있다
  1. Root 권한
  2. Sampling
  3. Elicitaion
- 위 3가지 기능을 사용하기 위해서는 initialization 요청 시 아래 필드가 반드시 선언되어야 한다
```json
{
  "capabilities": {
    "roots": {
    //   "listChanged": true
    },
    "sampling": {},
    "elicitation": {}
  }
}
```

## Root
- Root관련 구현시 반드시 구현해야 하는 것(MCP CLIENT)
  1. 서버에 루트를 요청하기 전에 반드시 사용자의 동의를 구한다
  2. 루트 관리를 위한 명확한 인터페이스를 USER에게 제공한다
  3. 루트 노출 전 접근 가능성을 반드시 검증한다
  4. 루트 변경 사항을 모니터링 한다
- Root관련 구현시 반드시 구현해야 하는 것(MCP SERVER)
  1. 루트 사용전 기능을 확인한다
  2. 루트 리스트 변경시 변경사항을 처리한다
  3. 루트 정보를 적절하게 캐시한다

## Sampling

> https://www.mcpevals.io/blog/mcp-sampling-explained

- 위 링크의 예시를보면 Server는 API key를 노출하지않고, Client에 LLM 사용 요청을 보내는 것이다
- MCP의 '샘플링'은 서버가 클라이언트의 LLM을 활용해 원하는 결과를 얻어내는 '프롬프팅 요청'이다

## Elicitation

- MCP Elicitation은 상호작용 중에 서버가 클라이언트를 통해 사용자에게 추가 정보를 요청할 수 있는 표준화된 방식

## MCP Server가 Samping, Elicitation 처럼 먼저 요청이 가능한 이유

- 서버가 클라이언트에게 먼저 데이터를 보내는 기능은 SSE(Server-Sent Events) 또는 스트림(Streaming) 방식으로 구현될 수 있다. 
- 두 기술 모두 서버가 연결을 끊지 않고 데이터를 계속해서 보낼 수 있게 해주지만, 작동 방식과 목적에 차이가 있다.

### SSE (Server-Sent Events): 서버가 보내는 '알림'
- SSE는 서버가 클라이언트에게 '이벤트'를 기반으로 한 단방향 텍스트 메시지를 지속적으로 보내기 위한 표준 기술이다. 
- 이름 그대로 서버가 보내는(Server-Sent) 이벤트(Events)이다

#### 작동 방식
- 클라이언트가 서버에 최초 한 번 HTTP 요청을 보낸다
- 서버는 이 연결을 끊지 않고 계속 유지한다
- 서버는 새로운 데이터(이벤트)가 생길 때마다, 정해진 텍스트 형식(data: ...\n\n)에 맞춰 클라이언트에게 메시지를 보낸다

#### 핵심 특징
- 단방향 통신: 오직 서버에서 클라이언트로만 데이터를 보낼 수 있다
- 자동 재연결: 네트워크 연결이 잠시 끊어져도 클라이언트(브라우저)가 자동으로 재연결을 시도하는 기능이 내장되어 있다.
- 이벤트 기반: 각 메시지에 '이벤트 이름'을 부여할 수 있어, 클라이언트가 메시지 종류에 따라 다른 작업을 처리하기 편리하다.
- 주요 용도: 실시간 알림, 뉴스 피드 업데이트, 주식 시세 변화, 스포츠 경기 스코어 업데이트 등 서버가 클라이언트에게 주기적으로 정보를 알려줘야 할 때 적합하다.

### 스트림 (Streaming): 데이터를 '나눠서 보내는' 기술
- 스트리밍은 본래 하나의 큰 데이터 덩어리를 잘게 쪼개어 순서대로 연속적으로 보내는 기술 자체를 의미한다. 
- 수도꼭지를 틀면 물이 한 번에 쏟아지는 게 아니라 계속 흘러나오는 것과 같다.

#### 작동 방식
- 클라이언트가 서버에 데이터를 요청한다
- 서버는 전체 데이터를 한 번에 준비해서 보내는 대신, 준비되는 대로 데이터 조각(chunk)을 즉시 보내기 시작한다.
- 서버는 모든 조각을 다 보낼 때까지 연결을 유지한다.

#### 핵심 특징
- 응답 시간 단축: 전체 파일 다운로드를 기다릴 필요 없이 데이터의 첫 부분을 바로 받아 처리할 수 있다.
- 대용량 데이터 처리: 동영상 파일이나 거대한 AI 모델의 응답처럼 매우 큰 데이터를 메모리에 모두 올리지 않고도 효율적으로 전송할 수 있다.
- 형식의 유연성: SSE처럼 정해진 텍스트 형식이 필수는 아니며, 비디오 데이터, JSON 조각 등 다양한 형태의 데이터를 스트리밍할 수 있다.
- 주요 용도: 동영상/음악 스트리밍 서비스(유튜브, 넷플릭스), 대용량 파일 다운로드, ChatGPT처럼 AI가 생성하는 텍스트를 실시간으로 보여주는 기능 등에 사용된다.